from astrostudy.helper import convertLonStrToDegree


days = [
    "01-01", "01-02", "01-03", "01-04", "01-05", "01-06", "01-07", "01-08", "01-09", "01-10",
    "01-11", "01-12", "01-13", "01-14", "01-15", "01-16", "01-17", "01-18", "01-19", "01-20",
    "01-21", "01-22", "01-23", "01-24", "01-25", "01-26", "01-27", "01-28", "01-29", "01-30", "01-31",

    "02-01", "02-02", "02-03", "02-04", "02-05", "02-06", "02-07", "02-08", "02-09", "02-10",
    "02-11", "02-12", "02-13", "02-14", "02-15", "02-16", "02-17", "02-18", "02-19", "02-20",
    "02-21", "02-22", "02-23", "02-24", "02-25", "02-26", "02-27", "02-28", "02-29",

    "03-01", "03-02", "03-03", "03-04", "03-05", "03-06", "03-07", "03-08", "03-09", "03-10",
    "03-11", "03-12", "03-13", "03-14", "03-15", "03-16", "03-17", "03-18", "03-19", "03-20",
    "03-21", "03-22", "03-23", "03-24", "03-25", "03-26", "03-27", "03-28", "03-29", "03-30", "03-31",

    "04-01", "04-02", "04-03", "04-04", "04-05", "04-06", "04-07", "04-08", "04-09", "04-10",
    "04-11", "04-12", "04-13", "04-14", "04-15", "04-16", "04-17", "04-18", "04-19", "04-20",
    "04-21", "04-22", "04-23", "04-24", "04-25", "04-26", "04-27", "04-28", "04-29", "04-30",

    "05-01", "05-02", "05-03", "05-04", "05-05", "05-06", "05-07", "05-08", "05-09", "05-10",
    "05-11", "05-12", "05-13", "05-14", "05-15", "05-16", "05-17", "05-18", "05-19", "05-20",
    "05-21", "05-22", "05-23", "05-24", "05-25", "05-26", "05-27", "05-28", "05-29", "05-30", "05-31",

    "06-01", "06-02", "06-03", "06-04", "06-05", "06-06", "06-07", "06-08", "06-09", "06-10",
    "06-11", "06-12", "06-13", "06-14", "06-15", "06-16", "06-17", "06-18", "06-19", "06-20",
    "06-21", "06-22", "06-23", "06-24", "06-25", "06-26", "06-27", "06-28", "06-29", "06-30",

    "07-01", "07-02", "07-03", "07-04", "07-05", "07-06", "07-07", "07-08", "07-09", "07-10",
    "07-11", "07-12", "07-13", "07-14", "07-15", "07-16", "07-17", "07-18", "07-19", "07-20",
    "07-21", "07-22", "07-23", "07-24", "07-25", "07-26", "07-27", "07-28", "07-29", "07-30", "07-31",

    "08-01", "08-02", "08-03", "08-04", "08-05", "08-06", "08-07", "08-08", "08-09", "08-10",
    "08-11", "08-12", "08-13", "08-14", "08-15", "08-16", "08-17", "08-18", "08-19", "08-20",
    "08-21", "08-22", "08-23", "08-24", "08-25", "08-26", "08-27", "08-28", "08-29", "08-30", "08-31",

    "09-01", "09-02", "09-03", "09-04", "09-05", "09-06", "09-07", "09-08", "09-09", "09-10",
    "09-11", "09-12", "09-13", "09-14", "09-15", "09-16", "09-17", "09-18", "09-19", "09-20",
    "09-21", "09-22", "09-23", "09-24", "09-25", "09-26", "09-27", "09-28", "09-29", "09-30",

    "10-01", "10-02", "10-03", "10-04", "10-05", "10-06", "10-07", "10-08", "10-09", "10-10",
    "10-11", "10-12", "10-13", "10-14", "10-15", "10-16", "10-17", "10-18", "10-19", "10-20",
    "10-21", "10-22", "10-23", "10-24", "10-25", "10-26", "10-27", "10-28", "10-29", "10-30", "10-31",

    "11-01", "11-02", "11-03", "11-04", "11-05", "11-06", "11-07", "11-08", "11-09", "11-10",
    "11-11", "11-12", "11-13", "11-14", "11-15", "11-16", "11-17", "11-18", "11-19", "11-20",
    "11-21", "11-22", "11-23", "11-24", "11-25", "11-26", "11-27", "11-28", "11-29", "11-30",

    "12-01", "12-02", "12-03", "12-04", "12-05", "12-06", "12-07", "12-08", "12-09", "12-10",
    "12-11", "12-12", "12-13", "12-14", "12-15", "12-16", "12-17", "12-18", "12-19", "12-20",
    "12-21", "12-22", "12-23", "12-24", "12-25", "12-26", "12-27", "12-28", "12-29", "12-30", "12-31"
]

offsets = [
    -3 * 60 - 9, -3 * 60 - 38, -4 * 60 - 6, -4 * 60 - 33, -5 * 60 - 1, -5 * 60 - 27, -5 * 60 - 54, -6 * 60 - 20,
    -6 * 60 - 45, -7 * 60 - 10,
    -7 * 60 - 35, -7 * 60 - 59, -8 * 60 - 22, -8 * 60 - 45, -9 * 60 - 7, -9 * 60 - 28, -9 * 60 - 49, -10 * 60 - 9,
    -10 * 60 - 28, -10 * 60 - 47,
    -11 * 60 - 5, -11 * 60 - 22, -11 * 60 - 38, -11 * 60 - 54, -12 * 60 - 8, -12 * 60 - 22, -12 * 60 - 35,
    -12 * 60 - 59, -13 * 60 - 10, -13 * 60 - 19, -13 * 60 - 37,

    -13 * 60 - 44, -13 * 60 - 50, -13 * 60 - 56, -14 * 60 - 1, -14 * 60 - 5, -14 * 60 - 9, -14 * 60 - 11, -14 * 60 - 13,
    -14 * 60 - 14, -14 * 60 - 15,
    -14 * 60 - 14, -14 * 60 - 13, -14 * 60 - 11, -14 * 60 - 8, -14 * 60 - 5, -14 * 60 - 1, -13 * 60 - 56, -13 * 60 - 51,
    -13 * 60 - 44, -13 * 60 - 38,
    -13 * 60 - 30, -13 * 60 - 22, -13 * 60 - 13, -11 * 60 - 4, -12 * 60 - 54, -12 * 60 - 43, -12 * 60 - 32,
    -12 * 60 - 21, -12 * 60 - 8,

    -11 * 60 - 56, -11 * 60 - 43, -11 * 60 - 29, -11 * 60 - 15, -11 * 60 - 1, -10 * 60 - 47, -10 * 60 - 32,
    -10 * 60 - 16, -10 * 60 - 1, -9 * 60 - 45,
    -9 * 60 - 28, -9 * 60 - 12, -8 * 60 - 55, -8 * 60 - 38, -8 * 60 - 21, -8 * 60 - 4, -7 * 60 - 46, -7 * 60 - 29,
    -7 * 60 - 11, -6 * 60 - 53,
    -6 * 60 - 35, -6 * 60 - 17, -5 * 60 - 58, -5 * 60 - 40, -5 * 60 - 22, -5 * 60 - 4, -4 * 60 - 45, -4 * 60 - 27,
    -4 * 60 - 9, -3 * 60 - 51, -3 * 60 - 33,

    -3 * 60 - 16, -2 * 60 - 58, -2 * 60 - 41, -2 * 60 - 24, -2 * 60 - 7, -1 * 60 - 50, -1 * 60 - 33, -1 * 60 - 17,
    -1 * 60 - 1, 0 * 60 + 46,
    0 * 60 + 30, 0 * 60 + 16, 0 * 60 + 1, 0 * 60 + 13, 0 * 60 + 27, 0 * 60 + 41, 0 * 60 + 54, 1 * 60 + 6, 1 * 60 + 19,
    1 * 60 + 31,
    1 * 60 + 42, 1 * 60 + 53, 2 * 60 + 4, 2 * 60 + 14, 2 * 60 + 23, 2 * 60 + 33, 2 * 60 + 41, 2 * 60 + 49, 2 * 60 + 57,
    3 * 60 + 4,

    3 * 60 + 10, 3 * 60 + 16, 3 * 60 + 21, 3 * 60 + 26, 3 * 60 + 30, 3 * 60 + 37, 3 * 60 + 36, 3 * 60 + 39, 3 * 60 + 40,
    3 * 60 + 42,
    3 * 60 + 42, 3 * 60 + 42, 3 * 60 + 42, 3 * 60 + 41, 3 * 60 + 39, 3 * 60 + 37, 3 * 60 + 34, 3 * 60 + 31, 3 * 60 + 27,
    3 * 60 + 23,
    3 * 60 + 18, 3 * 60 + 13, 3 * 60 + 7, 3 * 60 + 1, 2 * 60 + 54, 2 * 60 + 47, 2 * 60 + 39, 2 * 60 + 31, 2 * 60 + 22,
    2 * 60 + 13, 2 * 60 + 4,

    1 * 60 + 54, 1 * 60 + 44, 1 * 60 + 34, 1 * 60 + 23, 1 * 60 + 12, 1 * 60 + 0, 0 * 60 + 48, 0 * 60 + 36, 0 * 60 + 24,
    0 * 60 + 12,
    0 * 60 + 1, 0 * 60 - 14, 0 * 60 - 39, 0 * 60 - 52, -1 * 60 - 5, -1 * 60 - 18, -1 * 60 - 31, -1 * 60 - 45,
    -1 * 60 - 57, -2 * 60 - 10,
    -2 * 60 - 23, -2 * 60 - 36, -2 * 60 - 48, -3 * 60 - 1, -3 * 60 - 13, -3 * 60 - 25, -3 * 60 - 37, -3 * 60 - 49,
    -4 * 60 - 0, -4 * 60 - 11,

    -4 * 60 - 22, -4 * 60 - 33, -4 * 60 - 43, -4 * 60 - 53, -5 * 60 - 2, -5 * 60 - 11, -5 * 60 - 20, -5 * 60 - 28,
    -5 * 60 - 36, -5 * 60 - 43,
    -5 * 60 - 50, -5 * 60 - 56, -6 * 60 - 2, -6 * 60 - 8, -6 * 60 - 12, -6 * 60 - 16, -6 * 60 - 20, -6 * 60 - 23,
    -6 * 60 - 25, -6 * 60 - 27,
    -6 * 60 - 29, -6 * 60 - 29, -6 * 60 - 29, -6 * 60 - 29, -6 * 60 - 28, -6 * 60 - 26, -6 * 60 - 24, -6 * 60 - 21,
    -6 * 60 - 17, -6 * 60 - 13, -6 * 60 - 8,

    -6 * 60 - 3, -5 * 60 - 57, -5 * 60 - 51, -5 * 60 - 44, -5 * 60 - 36, -5 * 60 - 28, -5 * 60 - 19, -5 * 60 - 10,
    -5 * 60 - 0, -4 * 60 - 50,
    -4 * 60 - 39, -4 * 60 - 27, -4 * 60 - 15, -4 * 60 - 2, -3 * 60 - 49, -3 * 60 - 36, -3 * 60 - 21, -3 * 60 - 7,
    -2 * 60 - 51, -2 * 60 - 36,
    -2 * 60 - 20, -2 * 60 - 3, -1 * 60 - 47, -1 * 60 - 29, -1 * 60 - 12, 0 * 60 - 54, 0 * 60 - 35, 0 * 60 - 17,
    0 * 60 - 2, 0 * 60 + 21, 0 * 60 + 41,

    1 * 60 + 0, 1 * 60 + 20, 1 * 60 + 40, 2 * 60 + 1, 2 * 60 + 21, 2 * 60 + 42, 3 * 60 + 3, 3 * 60 + 3, 3 * 60 + 24,
    3 * 60 + 45,
    4 * 60 + 6, 4 * 60 + 27, 4 * 60 + 48, 5 * 60 + 10, 5 * 60 + 31, 5 * 60 + 53, 6 * 60 + 14, 6 * 60 + 35, 6 * 60 + 57,
    7 * 60 + 18,
    7 * 60 + 39, 8 * 60 + 0, 8 * 60 + 21, 8 * 60 + 42, 9 * 60 + 2, 9 * 60 + 22, 9 * 60 + 42, 10 * 60 + 2, 10 * 60 + 21,
    10 * 60 + 40,

    10 * 60 + 59, 11 * 60 + 18, 11 * 60 + 36, 11 * 60 + 36, 11 * 60 + 53, 12 * 60 + 11, 12 * 60 + 28, 12 * 60 + 44,
    12 * 60 + 60, 13 * 60 + 16,
    13 * 60 + 16, 13 * 60 + 31, 13 * 60 + 45, 13 * 60 + 59, 14 * 60 + 13, 14 * 60 + 26, 14 * 60 + 38, 14 * 60 + 50,
    15 * 60 + 1, 15 * 60 + 12,
    15 * 60 + 21, 15 * 60 + 31, 15 * 60 + 40, 15 * 60 + 48, 15 * 60 + 55, 16 * 60 + 1, 16 * 60 + 7, 16 * 60 + 12,
    16 * 60 + 16, 16 * 60 + 20, 16 * 60 + 22,

    16 * 60 + 24, 16 * 60 + 25, 16 * 60 + 24, 16 * 60 + 24, 16 * 60 + 23, 16 * 60 + 21, 16 * 60 + 17, 16 * 60 + 13,
    16 * 60 + 9, 16 * 60 + 3,
    15 * 60 + 56, 15 * 60 + 49, 15 * 60 + 41, 15 * 60 + 32, 15 * 60 + 22, 15 * 60 + 11, 15 * 60 + 0, 14 * 60 + 47,
    14 * 60 + 37, 14 * 60 + 20,
    14 * 60 + 6, 13 * 60 + 50, 13 * 60 + 34, 13 * 60 + 17, 12 * 60 + 59, 12 * 60 + 40, 12 * 60 + 21, 12 * 60 + 1,
    11 * 60 + 40, 11 * 60 + 18,

    10 * 60 + 56, 10 * 60 + 33, 10 * 60 + 9, 9 * 60 + 45, 9 * 60 + 21, 8 * 60 + 55, 8 * 60 + 29, 8 * 60 + 3,
    7 * 60 + 36, 7 * 60 + 9,
    6 * 60 + 42, 6 * 60 + 14, 5 * 60 + 46, 5 * 60 + 17, 4 * 60 + 48, 4 * 60 + 19, 3 * 60 + 50, 3 * 60 + 21, 2 * 60 + 51,
    2 * 60 + 22,
    1 * 60 + 52, 1 * 60 + 22, 0 * 60 + 52, 0 * 60 + 23, 0 * 60 + 7, 0 * 60 - 37, -1 * 60 - 6, -1 * 60 - 36, -2 * 60 - 5,
    -2 * 60 - 34, -3 * 60 - 3
]

offsetMap = {}

def initOffsetMap():
    if '01-01' in offsetMap.keys():
        return

    for i in range(0, len(days)):
        m = days[i]
        offsetMap[m] = offsets[i]

def getOffset(monthday, gpsLon, baseLon):
    parts = monthday.split(' ')
    mday = parts[0]
    realsun = offsetMap[mday]
    lonTmDelta = (gpsLon - baseLon) * 240
    return int(lonTmDelta + realsun)

def getOffsetBylonstr(monthday, lonstr, baseLon):
    londeg = convertLonStrToDegree(lonstr)
    return getOffset(monthday, londeg, baseLon)

def getBaseLonByZone(zone):
    sym = zone[0:1]
    hour = zone[1:3]
    if hour[0] == '0':
        hour = hour[1:2]
    h = int(hour)
    lon = h * 15
    if sym == '+':
        return lon
    return -lon

def getOffsetByDate(birth, zone, lon):
    initOffsetMap()
    baseLon = getBaseLonByZone(zone)
    monthday = birth
    if monthday[0] == '-':
        sz = len(monthday)
        monthday = monthday[1:sz]
    if monthday.find(' ') >= 0:
        parts = monthday.split(' ')
        monthday = parts[0]
    parts = monthday.split('-')
    if len(parts) > 0:
        monthday = '{0}-{1}'.format(parts[1], parts[2])
    timeOffset = getOffsetBylonstr(monthday, lon, baseLon)
    return timeOffset
