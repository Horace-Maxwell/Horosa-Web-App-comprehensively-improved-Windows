export const QIMEN_STATUS_EXPLANATIONS = {
	击刑: '多主阻隔、冲突、刑伤与执行受阻，用兵与冒进尤忌。',
	入墓: '主气机受困、推进乏力，吉事减力，凶事多呈闷滞。',
	门迫: '吉门遇迫则吉不就，凶门遇迫则凶更甚，需付出更高代价。',
	空亡: '象意落空、兑现折损，利于虚化避险，不利于实质落地。',
	驿马: '主迁移、奔波与应变，宜机动，不宜久守。',
};

export const QIMEN_PATTERN_EXPLANATIONS = {
	天遁: '丙丁与生门相会，利祈福、上书、出师与百事推进。',
	地遁: '乙己得开门并乘助神，利设伏、建置、修造与隐蔽行事。',
	人遁: '丁乙配休生门并临太阴，利求贤、和谈、交易与隐藏谋划。',
	风遁: '乙奇合三吉门临巽，利借风势、行军火攻与机密传递。',
	云遁: '乙辛合三吉门临坤，利祷雨、伏兵、建营与遁藏行动。',
	龙遁: '乙壬合三吉门临坎，利水战、修渠、行舟与机谋运水。',
	虎遁: '乙辛合休生门临艮，利守险、伏兵、冲锋与镇邪捕猎。',
	神遁: '丙奇生门临九天，利祭祀、设坛、奇谋与行军建功。',
	鬼遁: '辛丁合休生杜并临艮九地，利侦察、偷营、反间与驱邪。',
	真诈: '三奇合开休生并临太阴，利暗计、埋伏、隐遁。',
	重诈: '三奇合开休生并临九地，利招兵、修筑、埋葬。',
	休诈: '三奇合开休生并临六合，利祈祷、婚姻、交易、赴任。',
	天假: '景门合三奇临九天，利上书献策、扬威申令。',
	地假: '杜门合丁己癸临九地，利潜伏、间谍、暗线交通。',
	人假: '惊门同壬临九天，利捕逃、擒盗、搜匿。',
	鬼假: '死门同丁己癸临九地，利安葬、埋伏、筑堤通渠。',
	物假: '伤门同丁己癸临六合，利索取、交易、修旧与伏藏。',
	青龙回首: '戊加丙，百事多顺、谋为易成。',
	飞鸟跌穴: '丙加戊，显达易成、行动见功。',
	三奇得使: '日干配得使三奇，诸事多吉，可化险增益。',
	玉女守门: '时干配玉女守门，营建喜庆与宴会事吉。',
	天辅时: '遇天辅大吉时，百事可举，行军尤利。',
	三奇升殿: '乙到震、丙到离、丁到兑，三奇归殿百事吉。',
	奇游禄位: '三奇至本禄之宫，谋为与求财多成。',
	欢怡: '三奇临值符之宫，谋为和悦、协作顺畅。',
	相佐: '值符加地盘三奇，得外助而行事得力。',
	奇仪相合: '奇与仪同宫得吉门，主和合、协作、成事。',
	交泰: '乙加丁或丁加丙并遇吉门，主客皆利。',
	天运昌气: '六丁加六乙并得吉门，主客俱利、百事可为。',
	门宫和义: '吉门与宫位相生，比和得地，利于推进与落地。',
	青龙逃走: '乙辛相加，主破财、离散、举事多凶。',
	白虎猖狂: '辛乙相加，主冲突受伤，行兵婚造尤忌。',
	螣蛇夭矫: '癸丁相加，主虚惊、妖扰、主动不利。',
	朱雀投江: '丁癸相加，主文书泄漏、口舌与火灾隐患。',
	太白火荧: '庚丙相加，主贼扰劫营，诸事多凶。',
	荧入太白: '丙庚相加，主敌退可追，局势反复而险。',
	飞宫格: '值符临地庚，主先动多败，宜静守慎行。',
	伏宫格: '六庚伏值符，主进退受阻、行事多伤。',
	飞干格: '日干加庚，主飞灾横祸，主客俱伤。',
	伏干格: '庚加日干，主遭擒受制，出行尤忌。',
	大格: '庚加癸，主阻隔破耗，出行不利。',
	小格: '庚加壬，主天罗缠绕，行兵出行忌。',
	刑格: '庚加己，主官刑阻隔，诸事多凶。',
	悖格: '丙加年/月/日/时干或犯值符，主纲纪紊乱、举事乖悖。',
	年月日时格: '庚加岁月日时干，百事不利，宜守不宜动。',
	天网四张格: '癸癸天网，主进退受限、行事难通。',
	地罗遮格: '壬加时干为地罗，主出行与举兵受遮障。',
	五不遇时: '时干克日干且同性，主时机逆背、百事多阻。',
	六仪击刑: '六仪相刑，主祸不单行、伤灾与官刑并见。',
	三奇入墓: '乙丙丁入墓宫，吉力受困，谋为无功。',
	时干入墓: '时干落墓，主推进受阻，办事多滞。',
	星门入墓: '门星落墓，主谋事阻滞不通。',
	伏吟: '星门符还本宫，宜静守，忌急进妄动。',
	返吟: '星门符临对冲，主反复波动，宜审势先机。',
	门宫迫制: '门迫或宫制并见，吉事减力、凶事易激化。',
};

const QIMEN_PATTERN_ALIAS = {
	太白入荧: '太白火荧',
	天网四张: '天网四张格',
	地罗遮: '地罗遮格',
	返吟: '返吟',
};

export function appendQimenExplanation(labelOrText){
	const txt = `${labelOrText || ''}`.trim();
	if(!txt){
		return '';
	}
	if(txt.indexOf('击刑') >= 0){
		return `${txt}：${QIMEN_STATUS_EXPLANATIONS.击刑}`;
	}
	if(txt.indexOf('入墓') >= 0){
		return `${txt}：${QIMEN_STATUS_EXPLANATIONS.入墓}`;
	}
	if(txt.indexOf('门迫') >= 0){
		return `${txt}：${QIMEN_STATUS_EXPLANATIONS.门迫}`;
	}
	if(txt.indexOf('空亡') >= 0){
		return `${txt}：${QIMEN_STATUS_EXPLANATIONS.空亡}`;
	}
	if(txt.indexOf('驿马') >= 0 || txt.indexOf('日马') >= 0){
		return `${txt}：${QIMEN_STATUS_EXPLANATIONS.驿马}`;
	}
	return txt;
}

function normalizePatternName(name){
	const raw = `${name || ''}`.trim();
	if(!raw){
		return '';
	}
	return QIMEN_PATTERN_ALIAS[raw] || raw;
}

export function appendQimenPatternExplanation(name){
	const normName = normalizePatternName(name);
	if(!normName){
		return '';
	}
	const body = QIMEN_PATTERN_EXPLANATIONS[normName];
	return body ? `${normName}：${body}` : normName;
}

export function appendQimenPatternList(patterns){
	return (patterns || [])
		.map((name)=>appendQimenPatternExplanation(name))
		.filter((item)=>!!item);
}
